{% extends "layout.html" %}

{% block title %}
    Table 
{% endblock %}

{% block main %}


<!-- Delete worked yesterday, but now I get the following exception with multiple selected entries:

DeprecationWarning: 'session_cookie_name' is deprecated and will be removed in Flask 2.3. Use 'SESSION_COOKIE_NAME' in 'app.config' instead.
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/XXXXX/miniconda3/envs/cs50/lib/python3.11/site-packages/flask/app.py", line 1844, in finalize_request
    response = self.process_response(response)

This happends when cs50 library tries to delete the second or third element from the database, although it worked for the first element(s). 
This might be a problem of using the CS50 library?

I am removing the feature for now. 



<div class="container-fluid">
    <div class="text-start card-smaller">
        <button type="button" class="btn btn-outline-secondary" onclick="checkAll()">Select all</button>
        <button type="button" class="btn btn-outline-secondary" onclick="uncheckAll()">Clear</button>
        <button type="button" class="btn btn-outline-danger" onclick="deleteselected()">Delete</button>

        
    </div>
-->

    <table class="table table-striped size90 table-sm" id="mytable">
        <thead>
            <tr>
                <th class="text-start" onclick="sortTable(0)">ID<img src="static/sort-solid.svg" width="10px" height="10px"></th>
                <th class="text-start" onclick="sortTable(1)">Title<img src="static/sort-solid.svg" width="10px" height="10px"></th>
                <th class="text-start" onclick="sortTable(2)">Number<img src="static/sort-solid.svg" width="10px" height="10px"></th>
                <th class="text-start" onclick="sortTable(3)">Minerals<img src="static/sort-solid.svg" width="10px" height="10px"></th>
                <th class="text-start" onclick="sortTable(4)">Locality<img src="static/sort-solid.svg" width="10px" height="10px"></th>
                <th class="text-start" onclick="sortTable(5)">Date<img src="static/sort-solid.svg" width="10px" height="10px"></th>
                <th class="text-start" onclick="sortTable(6)">Tags<img src="static/sort-solid.svg" width="10px" height="10px"></th>
                <th class="text-start">Notes</th>
                
            </tr>
        </thead>
        <tbody>
            <!-- Loop through the database entries to display them in this table -->
            {% for row in rows %}
            <tr id="tr{{ row['id'] }}">
                <!--
                <td>
                    
                        <input type="checkbox" class="form-check-input mycheckboxes" name="checkboxes" value="{{ row['id'] }}">
                   
                </td>
                -->
                <td class="text-start">{{ row['id'] }}</td>
                <td class="text-start">{{ row['title'] }}</td>
                <td class="text-start">{{ row['my_id'] }}</td>
                <td class="text-start">
                    {% for min in row['minerals'] %}
                    {{ min['name'] | minlink | safe }},
                    {% endfor %}
                </td>
                <td class="text-start">{{ row['locality'] | shortnotes }}</td>
                <td class="text-start">{{ row['year'] | date4}}-{{ row['month'] | date2 }}-{{ row['day'] | date2 }}</td>
                <td class="text-start">
                    {% for tag in row['tags'] %}
                    {{ tag['tag'] | taglink | safe }},
                    {% endfor %}
                </td>
                <td class="text-start">{{ row['notes'] | shortnotes }}</td>

                <td>
                    {% for th in row['thumb'] %}
                    {{ th['file'] | minithumb | safe }}
                    {% endfor %}
                </td>
                
                <td>
                    <form action="/view">
                        <input name="id" type="hidden" value="{{ row['id'] }}">
                        <input type="submit" value="View">
                    </form>
                </td>
                <td>
                    <form action="/edit">
                        <input name="id" type="hidden" value="{{ row['id'] }}">
                        <input type="submit" value="Edit">
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>

    </table>

    <script src="static/tableaction.js"></script>
</div>

<!-- Bootstrap Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Delete specimen</h5>
          </div>
        <div class="modal-body">
          Are you sure you want to delete these specimen?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger">Delete</button>
          
        </div>
      </div>
    </div>
  </div>

  <!-- end modal -->
  

{% endblock %}
